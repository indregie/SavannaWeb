@using Savanna.Backend
@using Savanna.Frontend

@{
    ViewBag.Title = "Savanna Game";
}

<h2>Welcome to Savanna!</h2>
<p>Loaded animals:</p>
@foreach (var kvp in AnimalFactory.AnimalTypes)
{
    <p>Enter @kvp.Key to add @kvp.Value.Name.</p>
}

<div>
    <form method="post" action="@Url.Action("HandleInput", "Game")">
        <input type="text" name="animalSymbol" />
        <input type="submit" value="Add animal" />
    </form>
</div>

<div>
    <h3>Game board:</h3>
    @await Html.PartialAsync("_Board", ViewData["UIManager"] as Savanna.Frontend.UIManager)
</div>

<script>
    function updateBoard() {
        $.ajax({
            url: 'Game/GetBoard',
            type: 'GET',
            success: function (data) {
                //update game board display with the received data
            }
        });
    }

    $(document).keypress(function (event) {
        var keyChar = String.fromCharCode(event.which).toUpperCase();
        $.ajax({
            url: 'Game/AddAnimal',
            type: 'POST',
            data: { animalSymbol: keyChar },
            success: function () {
                //optional, additional actions
            }
        })
    });

    setInterval(updateBoard, 1000);
</script>